pipeline {
    agent any

  options { buildDiscarder(logRotator(artifactDaysToKeepStr: '',
     artifactNumToKeepStr: '', daysToKeepStr: '3', numToKeepStr: '5'))
      disableConcurrentBuilds() }


    stages {

        stage('build') {
            steps {
                sh '''
            docker build -t yvan:01 .
                
                '''
            }
        }
     
     
     stage('Docker tag') {
            steps {
                sh '''
                docker tag yvan devopseasylearning2021/yvan:01
                
                '''
            }
        }


    stage('Docker login ') {
            steps {
               sh '''
   withCredentials([usernamePassword(credentialsId: 'dockerhub', passwordVariable: 'password', usernameVariable: 'username')]){
                         sh '''
                            echo "${password} | docker login -u ${username} --password-stdin"
                '''
            }
        }
    }

    stage('Docker push') {
            steps {
                sh '''
                docker push devopseasylearning2021/yvan:01
                
                '''
            }
        }
    
    
    
    }



}
