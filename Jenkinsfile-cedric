pipeline {
    agent any

    //Setting the environment variables USERNAME and PASSWORD
    environment {
       USERNAME = 'devopseasylearning2021'
       PASSWORD = 'DevOps2021@'

    }

   options { buildDiscarder(logRotator(artifactDaysToKeepStr: '',
     artifactNumToKeepStr: '', daysToKeepStr: '3', numToKeepStr: '5'))
      disableConcurrentBuilds() }


    stages {

        stage('build images') {
            steps {
                sh '''
                docker build -t cedric:001 .
                '''
            }
        }

    
        stage('tag images') {
            steps {
                sh '''
                docker tag cedric:001 devopseasylearning2021/cedric_0314:001
                '''
            }
        }




        stage('docker login') {
            steps {
                sh '''
                docker login -u USERNAME -p PASSWORD
                '''
            }
        }



        stage('docker push') {
            steps {
                sh '''
                docker push devopseasylearning2021/cedric_0314:001
                '''
            }
        }



        
    }
}
